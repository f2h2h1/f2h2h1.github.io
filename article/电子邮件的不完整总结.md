# 电子邮件的不完整总结

电子邮件 是最早的互联网应用之一。

- email
- e-mail
- Electronic Mail
- 电子的 邮件
- 电子邮件
- 电邮

## 组成

一个 电子邮件系统 至少由三部分组成
- mua
    - 使用 smtp 和 mta 通讯
    - 使用 imap 或 pop3 和 mda 通讯
- mta
    - 和其它 mta 通讯时也是使用 smtp
- mda
    - Mail Delivery Agent (邮件分发代理)
    - 虽然叫做分发代理，但实际上需要 mua 主动去拉取邮件
    - 使用 imap 或 pop3 和 mua 通讯
- mua 就类似于浏览器， mta 和 mda 就类似于 http服务器

一封 电子邮件 由两个部分组成
- 信封
    - 是指 smtp 信封 -> rfc 5321
    - SMTP “信封”是客户端发送给邮件服务器的一组信息，说明电子邮件来自何处和将前往何处。
    - SMTP 信封不同于电子邮件头和正文，对电子邮件收件人不可见。
    - 在电子邮件传递过程中，每次传送到一个不同的服务器时，这个信封都会被丢弃并替换。
- 消息
    - IMF
    - 这是一种类似于 http 报文的格式，也是分为两部分， headers 和 body 。
    - headers
        - Date 这是发送的日期，格式看上去像是 rfc-2822
        - From
        - To
        - Cc
        - Bcc
        - Subject
        - Reply-To 这是发件人期望回复的地址
        - MIME-Version 声明 MIME 版本
            通常都是 1.0
        - Content-Type 内容的类型
        - Content-Transfer-Encoding 内容编码的方式
            - 通常是 7bit 8bit binary base64
        - 以 X- 开头的是自定义的首部
        - 除了 from date to 是必须的之外，其它的可以为空
        - To Cc Bcc Subject 还有 Reply-To 可以由用户编写，其它的通常都由程序生成
    - body
        - 根据 headers 的 Content-Type 通常分为三种
            - text/plain
            - text/html
            - multipart/mixed

一封 电子邮件地址 由三个部分组成
- 用户名
- @ 符号
    - @ 符号 读作 at
    - @ 的意思就是 who at where ， user at domain
- 域名

总结一下就是 三种协议，一种格式
- SMTP
- IMAP
- POP3
- IMF (Internet Message Format)

<!--
### 客户端
### 服务端
## 三种协议，一种格式
### SMTP
### IMAP
### POP3
### Internet Message Format
-->

## 如何搭建一个邮件服务器
### 单机的在不同用户间发送邮件
### 在局域网里自娱自乐
### 能收发外网的邮件
## 使用命令行发送邮件
### 交互式命令
- 适用于 nc telnet openssl
### 非交互式命令
- sendmail
- curl
## php 发送邮件
### 使用原本的函数
- mail 和 mb_send_mail 函数
- windows 环境
- linux 环境
- 关注 sendmail 这个命令

### 使用第三方库
- https://github.com/PHPMailer/PHPMailer
- https://github.com/symfony/mailer
- https://github.com/laminas/laminas-mail
- https://github.com/zetacomponents/Mail

## 名词
